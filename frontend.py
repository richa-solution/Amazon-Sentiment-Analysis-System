import streamlit as st
from google_auth_oauthlib.flow import InstalledAppFlow
from googleapiclient.discovery import build
from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer
import pandas as pd
import plotly.express as px
st.set_page_config(page_title="Amazon Sentiment Analysis System")
st.title("Amazon Sentiment Analysis System")
choice=st.sidebar.selectbox("My Menu",("HOME","ANALYSIS","RESULTS"))
if(choice=="HOME"):
    st.image("data:image/jpeg;base64,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")
    st.write("1. It is a Natural Language Processing Application which can  analyze the sentiment on a text data.")
    st.write("2. This application predict the sentiments into 3 categories Positive, Negative  and Neutral")
    st.write("3. This Application can visualize the result based on different  factors such as age, gender, language, city.")
    st.write("4. This application can get data from Google sheet.")
    st.write("5. This is a web Application which can be accessed over a LAN.")
elif(choice=="ANALYSIS"):
    sid=st.text_input("Enter your Google Sheet ID")
    r=st.text_input("Enter range between first column and last column")
    c=st.text_input("Enter column name that is to be analyzed")
    btn=st.button("Analyze")
    if btn:
        if 'cred' not in st.session_state:
            f=InstalledAppFlow.from_client_secrets_file("key.json",["https://www.googleapis.com/auth/spreadsheets"])
            st.session_state['cred']=f.run_local_server(port=0)
        mymodel=SentimentIntensityAnalyzer()
        service=build("Sheets","v4",credentials=st.session_state['cred']).spreadsheets().values()
        k=service.get(spreadsheetId=sid,range=r).execute()
        d=k['values']
        df=pd.DataFrame(data=d[1:],columns=d[0])
        l=[]
        for i in range(0,len(df)):
            t=df._get_value(i,"Summary")
            pred=mymodel.polarity_scores(t)
            if(pred['compound']>=0.05):
                l.append("Positive")
            elif(pred['compound']<=0.05):
                l.append("Negative")
            else:
                l.append("Neutral")
        df['Sentiment']=l
        df.to_csv("results.csv",index=False)
        st.subheader("The Analysis results are saved by the name of a result.csv file")
elif(choice=="RESULTS"):
    df=pd.read_csv("results.csv")
    choice2=st.selectbox("Choose Visualization",("NONE","PIE CHART","HISTOGRAM","SCATTER PLOT"))
    st.dataframe(df)
    if(choice2=="PIE CHART"):
        posper=(len(df[df['Sentiment']=='Positive'])/len(df))*100
        negper=(len(df[df['Sentiment']=='Positive'])/len(df))*100 
        neuper=(len(df[df['Sentiment']=='Positive'])/len(df))*100
        fig=px.pie(values=[posper,negper,neuper],names=['Positive','Negative','Neutral'])
        st.plotly_chart(fig)
    elif(choice2=="HISTOGRAM"):
        k=st.selectbox("Choose Column",df.columns)
        if k:
            fig=px.histogram(x=df['ProductId'],y=df['Score'],color=df['Sentiment'])
            st.plotly_chart(fig)
    elif(choice2=="SCATTER PLOT"):
        k=st.text_input("Enter The Continous Coulmn Name")
        if k:
            fig=px.scatter(x=df['ProductId'],y=df['Summary'],color=df['Sentiment'],size=df['Score'])
            st.plotly_chart(fig)

